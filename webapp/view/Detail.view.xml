<mvc:View
    xmlns:mvc="sap.ui.core.mvc"
    xmlns:m="sap.m"
    xmlns="sap.uxap"
    xmlns:f="sap.f"
    xmlns:ui="sap.ui.table"
    xmlns:layout="sap.ui.layout"
    controllerName="ansaldonuclear.dashboard.controller.Detail"
    displayBlock="true"
>
    <ObjectPageLayout
        alwaysShowContentHeader="true"
        toggleHeaderOnTitleClick="true"
        backgroundDesignAnchorBar="Transparent"
        preserveHeaderStateOnScroll="true"
        showFooter="true"
        showTitleInHeaderContent="true"
    >
        <headerTitle>
            <ObjectPageDynamicHeaderTitle backgroundDesign="Translucent">
                <heading>
                    <layout:HorizontalLayout allowWrapping="true">
                        <m:Button
                            icon="sap-icon://nav-back"
                            press=".onNavBack"
                            tooltip="{i18n>navBack}"
                        />
                        <m:Title
                            text="{i18n>network} {detailModel>/AUFNR} - {detailModel>/KTEXT}"
                            level="H3"
                            wrapping="true"
                            class="sapUiTinyMargin"
                        />
                    </layout:HorizontalLayout>
                </heading>
                <actions>
                    <layout:HorizontalLayout allowWrapping="true">
                        <layout:VerticalLayout>
                            <m:Image
                                class='sapUiSmallMarginTop'
                                src="public/images/ansaldo_nucleare_logo.jpg"
                                height="40px"
                                width="100%"
                            />
                        </layout:VerticalLayout>
                    </layout:HorizontalLayout>
                </actions>
            </ObjectPageDynamicHeaderTitle>
        </headerTitle>

        <headerContent>
            <m:HBox
                justifyContent="SpaceBetween"
                width="100%"
                wrap="Wrap"
                class='objAtStyle'
            >
                <m:VBox>
                    <m:ObjectAttribute
                        title="{i18n>wbeParent}"
                        text="{detailModel>/PSPNR}"
                    />
                    <m:ObjectAttribute
                        title="{i18n>bStartDate}"
                        text="{path: 'detailModel>/GSTRP', formatter: '.formatter.formatDate'}"
                    />
                    <m:ObjectAttribute
                        title="{i18n>bFinishDate}"
                        text="{path: 'detailModel>/GLTRP', formatter: '.formatter.formatDate'}"
                    />
                </m:VBox>

                <m:VBox>
                    <m:ObjectAttribute
                        title="{i18n>opera}"
                        text="{detailModel>/OPERA}"
                    />
                    <m:ObjectAttribute
                        title="{i18n>status}"
                        text="{path: 'detailModel>/STATUS'}"
                    />
                    <m:ObjectAttribute
                        title="{i18n>dateOp}"
                        text="{path: 'detailModel>/DATEOP', formatter: '.formatter.formatDate'}"
                    />
                </m:VBox>
            </m:HBox>
        </headerContent>

        <sections>
            <ObjectPageSection title="{i18n>operations}">
                <subSections>
                    <ObjectPageSubSection>
                        <ui:Table
                            rows="{detailModel>/operations}"
                            selectionMode="None"
                            width="100%"
                            visible="{= ${detailModel>/operations/length} > 0 }"
                            ariaLabelledBy="title"
                        >
                            <ui:columns>
                                <ui:Column width="11rem">
                                    <m:Label text="{i18n>opNumb}" />
                                    <ui:template>
                                        <m:Text text="{detailModel>VORNR}" />
                                    </ui:template>
                                </ui:Column>
                                <ui:Column width="20rem">
                                    <m:Label text="{i18n>opDescr}" />
                                    <ui:template>
                                        <m:Text text="{detailModel>LTXA1}" />
                                    </ui:template>
                                </ui:Column>
                                <ui:Column width="12rem">
                                    <m:Label text="{i18n>actiStart}" />
                                    <ui:template>
                                        <m:DatePicker
                                            value="{path: 'detailModel>NTANF', formatter: '.formatter.formatDate'}"
                                            editable="false"
                                            displayFormat="dd/MM/yyyy"
                                        />
                                    </ui:template>
                                </ui:Column>
                                <ui:Column width="12rem">
                                    <m:Label text="{i18n>actiEnd}" />
                                    <ui:template>
                                        <m:DatePicker
                                            value="{path: 'detailModel>NTEND', formatter: '.formatter.formatDate'}"
                                            editable="false"
                                            displayFormat="dd/MM/yyyy"
                                        />
                                    </ui:template>
                                </ui:Column>
                                <!-- <ui:Column
                                    width="12rem"
                                    hAlign="Center"
                                >
                                    <m:Label text="{i18n>opera}" />
                                    <ui:template>
                                        <m:Text

                                            text="{detailModel>OPERA}"
                                        />
                                    </ui:template>
                                </ui:Column> -->
                                <ui:Column
                                    width="34rem"
                                    hAlign="Center"
                                >
                                    <m:Label text="{i18n>status}" />
                                    <ui:template>
                                        <m:Button
                                            type="{= ${detailModel>OPERA} === 'INS' ? 'Neutral': 'Attention'}"
                                            icon="{= ${detailModel>OPERA} === 'INS' ? 'sap-icon://create': 'sap-icon://edit'}"
                                        />
                                    </ui:template>
                                </ui:Column>

                                <!-- <ui:Column width="14rem">
                                    <m:Label text="{i18n>dateOp}" />
                                    <ui:template>
                                        <m:DatePicker
                                            value="{path: 'detailModel>DATEOP', formatter: '.formatter.formatDate'}"
                                            editable="false"
                                            displayFormat="dd/MM/yyyy"
                                        />
                                    </ui:template>
                                </ui:Column> -->
                            </ui:columns>
                        </ui:Table>
                    </ObjectPageSubSection>
                </subSections>
            </ObjectPageSection>
            <ObjectPageSection title="{i18n>log}">
                <subSections>
                    <ObjectPageSubSection>
                        <ui:TreeTable
                            selectionMode="None"
                            rows="{path: 'treemodel>/', parameters: {arrayNames: ['operations']}}"
                        >
                            <ui:Column label="{i18n>network}" width="15rem">
                                <ui:template>
                                    <m:Text text="{treemodel>AUFNR}" />
                                </ui:template>
                            </ui:Column >
                            <ui:Column label="{i18n>opNumb}" width="15rem">
                                <ui:template>
                                    <m:Text text="{treemodel>VORNR}" />
                                </ui:template>
                            </ui:Column>
                            <ui:Column hAlign="Center" label="{i18n>status}" width="15rem">
                                <ui:template>
                                    <m:Button
                                        type="{= ${treemodel>OPERA} === 'INS' ? 'Neutral': 'Attention'}"
                                        icon="{= ${treemodel>OPERA} === 'INS' ? 'sap-icon://create': 'sap-icon://edit'}"
                                    />
                                </ui:template>
                            </ui:Column>
                            <ui:Column label="{i18n>opera}" width="15rem">
                                <ui:template>
                                    <m:Text text="{treemodel>OPERA}" />
                                </ui:template>
                            </ui:Column>
                            <ui:Column label="{i18n>dateOp}" width="15rem">
                                <ui:template>
                                    <m:Text
                                        text="{path: 'treemodel>DATEOP', formatter: '.formatter.formatDate'}"
                                    />
                                </ui:template>
                            </ui:Column>
                        </ui:TreeTable>
                    </ObjectPageSubSection>
                </subSections>
            </ObjectPageSection>
        </sections>
    </ObjectPageLayout>
</mvc:View>
